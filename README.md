# Core-Bitcoin Network Simulator for Performance Evaluation using Lightweight Virtualization

Core-Bitcoin simulator is built on Docker technology to generate local testing network. This tool is designed to test and assess the impact of any modifications to the original Bitcoin reference implementation. 

To setup a test network, the simulator accept several network and system arguments: 

- Network size (number of nodes).
- Hashing-power of each individual node.
- Block time.
- Delay on the egress traffic of each node.
- Delay jitter with Normal/Pareto distribution on each node.
- Simulation time.

The simulator will automatically adjust the mining difficulty of the generated network based on the configured block time, network hashing power and the network size to fit the testing  network topology and host machine cababilites. Note that difficulty adjusment will only last for the first 2016 blocks, then it will be tuned by the original difficulty adjusment logic hardecoded in the bitcion client implemention.  


The following reports are generated by the simulator during and at the end of the simulation:

- Number of generated blocks per node. 
- Number of blocks committed to the main chain per  node.
- Number of valid forks each node witnessed during the simulation.  
- Nodes with the highest and lowest number of mined blocks.
- Amount of spendable balance of each node. 
- Total network hashrate. 
- Plots of the calculated values.  


## Getting Started

Steps to make your first local Bitcoin testing network up and running on your local machine.

#### Clone the repository to your host machine:

```
$ git clone https://github.com/noureddinel/core-bitcoin-net-simulator
```

### Prerequisites

The following tools and packages must be installed in the machine:


- Docker * [Docker](https://phoenixnap.com/kb/how-to-install-docker-on-ubuntu-18-04) - To install Docker sucessfuly follow this link
- pumba
- matplotlib
- statstics
- python-tk

```
$ python prerequisites.py 
```

### Tutorial for setting up a multi-nodes local bitcion network  

Step 1: Open port 10345,12342,12343,12344,12345,12346 on your host machine

```
sudo ufw allow 10345 12342 12343 12344 12345 12346
```

Step 2: generating a local Bitcoin test network

```
$ python localtestnet.py
```

Note:
- If you are generating the network for the first time, it will take more time for docker setup.


Step 3: checking the docker continers' state

```
$ docker ps
```

Step 4: generating and view a performance report

```
$ python getperformance.py
```

Step 4: stopping network's miners

```
$ python stopminers.py

```

Step 5: teardown the setup 

```
$ python teardown.py
```

## Authors

* **Lina Alsahan** - *lialsahan@hbku.edu.qa* 
* **Noureddine Lasla** - *nlasla@hbku.edu.qa* 

